# U-Net Image Segmentation

Этот проект представляет собой реализацию архитектуры U-Net для сегментации изображений. Модель была адаптирована и обучена на датасете [Forest Aerial Images for Segmentation](https://www.kaggle.com/datasets/quadeer15sh/augmented-forest-segmentation), но может быть использована для решения других задач сегментации.

## Описание

U-Net — это архитектура нейронной сети, разработанная для задач сегментации изображений. Основная особенность модели заключается в U-образной структуре, которая позволяет эффективно использовать как глобальные, так и локальные особенности изображений для точной сегментации.

В данном репозитории представлена универсальная реализация U-Net, которая была обучена на изображениях леса с использованием набора данных с аэрофотосъемки.

## Датасет

Для обучения модели использовался набор данных [Forest Aerial Images for Segmentation](https://www.kaggle.com/datasets/quadeer15sh/augmented-forest-segmentation). Датасет содержит две подпапки:
- `images/`: исходные изображения
- `masks/`: маски для сегментации, где каждому пикселю соответствует класс объекта (лес, земля)

## Структура проекта

- `.env`: файл с настройками окружения
- `requirements.txt`: список зависимостей
- `data.py`: скрипт для извлечения и обработки данных
- `model.py`: скрипт для сборки модели U-Net
- `train.py`: скрипт для обучения модели
- `predict.py`: скрипт для предсказания на новых данных
- `logs/`: папка с логами для тренировочных и валидационных данных
- `results/`: папка с предсказаниями на тестовых данных
- `files/`: папка для хранения csv-логов и обученной модели (model.h5)
- `config/`: папка с файлом для извлечения переменной окружения
- `results_analysis.ipynb`: ноутбук для анализа csv-логов с метриками при обучении
  
## Установка

1. Склонируйте репозиторий:

   ```bash
   git clone https://github.com/Krashper/Image_Segmentation.git
   cd Image_Segmentation
   ```

2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

3. Скачайте набор данных с Kaggle и распакуйте его (Вы можете использововать любой датасет с картинками 256x256). В папке `data/` должны быть следующие директории:
   - `images/`: изображения
   - `masks/`: маски

4. Измените файл `.env`, указав путь до директории с данными:
   ```
   DATA_FOLDER=путь/до/папки/data
   ```

## Использование

### Обучение модели

Для запуска обучения используйте скрипт `train.py`. Перед этим убедитесь, что данные подготовлены и переменная `DATA_FOLDER` в файле `.env` указана верно:

```bash
python train.py
```

### Предсказание

Для использования обученной модели на новых данных выполните скрипт `predict.py`:

```bash
python predict.py
```

## Настройки и параметры

Все параметры для обучения модели можно настроить в соответствующем конфигурационном файле или прямо в коде скрипта `train.py`.

## Ресурсы

- Архитектура U-Net: [U-Net: Convolutional Networks for Biomedical Image Segmentation](https://arxiv.org/abs/1505.04597)
- Набор данных: [Forest Aerial Images for Segmentation](https://www.kaggle.com/datasets/quadeer15sh/augmented-forest-segmentation)

## Контакты

Если у вас есть вопросы или предложения, обращайтесь: [ruslan251207@gmail.com](mailto:ruslan251207@gmail.com)
